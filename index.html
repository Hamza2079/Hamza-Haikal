<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hamza-haikal</title>

    <!-- Preconnect to analytics domains for faster loading -->
    <link rel="preconnect" href="https://www.googletagmanager.com" />
    <link rel="preconnect" href="https://www.clarity.ms" />

    <!-- Optimized Analytics Loading -->
    <script>
      (function () {
        let analyticsLoaded = false;

        function loadAnalytics() {
          if (analyticsLoaded) return;
          analyticsLoaded = true;

          // Load Google Tag Manager
          const gtmScript = document.createElement("script");
          gtmScript.async = true;
          gtmScript.src =
            "https://www.googletagmanager.com/gtag/js?id=G-W2CG4E8ZPB";
          document.head.appendChild(gtmScript);

          gtmScript.onload = function () {
            window.dataLayer = window.dataLayer || [];
            function gtag() {
              dataLayer.push(arguments);
            }
            gtag("js", new Date());
            gtag("config", "G-W2CG4E8ZPB");
          };

          // Load Microsoft Clarity
          (function (c, l, a, r, i, t, y) {
            c[a] =
              c[a] ||
              function () {
                (c[a].q = c[a].q || []).push(arguments);
              };
            t = l.createElement(r);
            t.async = 1;
            t.src = "https://www.clarity.ms/tag/" + i;
            y = l.getElementsByTagName(r)[0];
            y.parentNode.insertBefore(t, y);
          })(window, document, "clarity", "script", "v63dq3xpmz");
        }

        // Use requestIdleCallback for better performance
        const scheduleLoad =
          window.requestIdleCallback ||
          function (cb) {
            setTimeout(cb, 1);
          };

        // Load after 3 seconds OR after first user interaction
        let interactionOccurred = false;
        const loadOnInteraction = function () {
          if (!interactionOccurred) {
            interactionOccurred = true;
            scheduleLoad(loadAnalytics);
            // Remove event listeners after first interaction
            window.removeEventListener("scroll", loadOnInteraction);
            window.removeEventListener("click", loadOnInteraction);
            window.removeEventListener("touchstart", loadOnInteraction);
          }
        };

        // Add interaction listeners
        window.addEventListener("scroll", loadOnInteraction, {
          passive: true,
          once: true,
        });
        window.addEventListener("click", loadOnInteraction, {
          passive: true,
          once: true,
        });
        window.addEventListener("touchstart", loadOnInteraction, {
          passive: true,
          once: true,
        });

        // Fallback: load after 3 seconds if no interaction
        setTimeout(function () {
          if (!interactionOccurred) {
            scheduleLoad(loadAnalytics);
          }
        }, 3000);
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
